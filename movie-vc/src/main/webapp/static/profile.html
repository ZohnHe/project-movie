
<!DOCTYPE html>

<!--[if IE 8]><html class="ie8"><![endif]-->
<!--[if IE 9]><html class="ie9"><![endif]-->
<!--[if gt IE 9]><!--><html><!--<![endif]-->
<head>
    <title>梦想影城</title>

    <link rel="dns-prefetch" href="//p0.meituan.net"  />
    <link rel="dns-prefetch" href="//p1.meituan.net"  />
    <link rel="dns-prefetch" href="//ms0.meituan.net" />
    <link rel="dns-prefetch" href="//s0.meituan.net" />
    <link rel="dns-prefetch" href="//ms1.meituan.net" />
    <link rel="dns-prefetch" href="//analytics.meituan.com" />
    <link rel="dns-prefetch" href="//report.meituan.com" />
    <link rel="dns-prefetch" href="//frep.meituan.com" />
    <!-- dropzone -->
    <link rel="stylesheet" href="../static/user/css/dropzone.css"/>


    <meta charset="utf-8">
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta http-equiv="cleartype" content="yes" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="renderer" content="webkit" />

    <meta name="HandheldFriendly" content="true" />
    <meta name="format-detection" content="email=no" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <script>"use strict";!function(){var i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"_Owl_",n=window;n[i]||(n[i]={isRunning:!1,isReady:!1,preTasks:[],dataSet:[],use:function(i,t){this.isReady&&n.Owl&&n.Owl[i](t),this.preTasks.push({api:i,data:[t]})},add:function(i){this.dataSet.push(i)},run:function(){var t=this;if(!this.isRunning){this.isRunning=!0;var i=n.onerror;n.onerror=function(){this.isReady||this.add({type:"jsError",data:arguments}),i&&i.apply(n,arguments)}.bind(this),(n.addEventListener||n.attachEvent)("error",function(i){t.isReady||t.add({type:"resError",data:[i]})},!0)}}},n[i].run())}();</script>

    <link rel="stylesheet" href="//s0.meituan.net/bs/?f=myfe/mywww:/common.ef9ce11a.css"/>
    <link rel="stylesheet" href="//s0.meituan.net/bs/?f=myfe/mywww:/profile-profile.13d06bf4.css"/>
    <script crossorigin="anonymous" src="//s0.meituan.net/bs/?f=myfe/mywww:/stat.88d57c80.js"></script>
    <script>if(window.devicePixelRatio >= 2) { document.write('<link rel="stylesheet" href="//s0.meituan.net/bs/?f=myfe/mywww:/image-2x.8ba7074d.css"/>') }</script>

</head>
<body>


<div class="header">
    <div class="header-inner">
        <a href="/static/index.html" style="float: left;"><img src="../static/user/image/mengxiang.jpg" style="width: 133px;height: 80px"></a>
        <!--<a href="/" class="logo" data-act="icon-click"></a>-->

        <div class="city-container" data-val="{currentcityid:20 }">

            <!--<div class="city-list" data-val="{ localcityid: 20 }">
                <div class="city-list-header">定位城市：<a class="js-geo-city">广州</a></div>

            </div>-->
        </div>


        <div class="nav">
            <ul class="navbar">
                <li><a href="/static/index.html" data-act="home-click"  >首页</a></li>
                <li><a href="/static/index.html" data-act="movies-click" >电影</a></li>
                <li><a href="/static/profile.html"  >个人中心</a></li>
            </ul>
        </div>

        <div class="user-info">
            <div class="user-avatar has-login">
                <img id="small_persionImg" src="https://img.meituan.net/maoyanuser/63957f10ae9679c95d4ba26ad1bd29c816882.png">
                <span class="caret"></span>
                <ul class="user-menu">
                    <li class="text">
                        <a href="/static/orders.html">我的订单</a>
                    </li>
                    <li class="text login-name" id="li_title"><a href="javascript:void 0">基本信息</a></li>
                    <li id="userLogout" class="text"><a href="/static/index.html">退出登录</a></li>
                </ul>
            </div>
        </div>



       <!-- <div class="app-download" style="visibility: hidden">
            <a href="#" target="_blank">
                <span class="iphone-icon"></span>
                <span class="apptext">APP下载</span>
                <span class="caret"></span>
            </a>
        </div>-->

    </div>
</div>
<div class="header-placeholder"></div>


<div class="container" id="app" class="page-profile/profile" >
    <div class="content">
        <div class="main">
            <div class="info-content clearfix">
                <div class="user-profile-nav">
                    <h1>个人中心</h1>
                    <a href="/static/orders.html" class="orders ">我的订单</a>
                    <a href="/static/profile.html" class="profile active">基本信息</a>
                </div>

                <div class="profile-container">
                    <div class="profile-title">
                        基本信息
                    </div>
                    <div class="avatar-container">
                        <div class="avatar-content">
                            <img id="personImg" class="J-setted-avatar" src="https://img.meituan.net/maoyanuser/63957f10ae9679c95d4ba26ad1bd29c816882.png">
                            <div id="file_id" class="form-group" style="display: none">
                                <label class="title">更换头像</label><br/>
                                <label class="title">最多只能传一张</label>
                                <div id="dropz" class="dropzone"></div>
                            </div>
                            <div class="J-upload-avatar-w upload-avatar-image">
                                <input type="button" id="upload_id" class="J-upload-avatar upload-btn" value="更换头像">

                                <!--<input type="file" id="fileUpload"  name="file"/>-->

                            </div>
                            <div class="tips">支持JPG,JPEG,PNG格式,且文件需小于1M</div>
                        </div>
                    </div>
                    <form id="J-userexinfo-form" class="userexinfo-form">
                        <div class="userexinfo-form-section">
                            <p>昵称：</p>
                            <span>
              <input type="text" name="nickName" id="userexinfo-form-nickname" class="ui-checkbox" placeholder="2-15个字，支持中英文、数字">
            </span>
                        </div>
                        <div class="userexinfo-form-section">
                            <p>性别：</p>
                            <span>
              <input type="radio" name="gender" id="userexinfo-form-gender-1" value="1"  class="ui-radio radio-first">
              <label for="userexinfo-form-gender-1">男</label>
            </span>
                            <span>
              <input type="radio" name="gender" id="userexinfo-form-gender-2" value="2"  class="ui-radio">
              <label for="userexinfo-form-gender-2">女</label>
            </span>
                        </div>
                        <div class="date-picker userexinfo-form-section">
                            <p>生日：</p>
                            <span>
    <div class="ui-select">
      <select name="year" class="ui-select">
        <option>--</option>
        <option value="2019">2019</option>
        <option value="2018">2018</option>
        <option value="2017">2017</option>
        <option value="2016">2016</option>
        <option value="2015">2015</option>
        <option value="2014">2014</option>
        <option value="2013">2013</option>
        <option value="2012">2012</option>
        <option value="2011">2011</option>
        <option value="2010">2010</option>
        <option value="2009">2009</option>
        <option value="2008">2008</option>
        <option value="2007">2007</option>
        <option value="2006">2006</option>
        <option value="2005">2005</option>
        <option value="2004">2004</option>
        <option value="2003">2003</option>
        <option value="2002">2002</option>
        <option value="2001">2001</option>
        <option value="2000">2000</option>
        <option value="1999">1999</option>
        <option value="1998">1998</option>
        <option value="1997">1997</option>
        <option value="1996">1996</option>
        <option value="1995">1995</option>
        <option value="1994">1994</option>
        <option value="1993">1993</option>
        <option value="1992">1992</option>
        <option value="1991">1991</option>
        <option value="1990">1990</option>
        <option value="1989">1989</option>
        <option value="1988">1988</option>
        <option value="1987">1987</option>
        <option value="1986">1986</option>
        <option value="1985">1985</option>
        <option value="1984">1984</option>
        <option value="1983">1983</option>
        <option value="1982">1982</option>
        <option value="1981">1981</option>
        <option value="1980">1980</option>
        <option value="1979">1979</option>
        <option value="1978">1978</option>
        <option value="1977">1977</option>
        <option value="1976">1976</option>
        <option value="1975">1975</option>
        <option value="1974">1974</option>
        <option value="1973">1973</option>
        <option value="1972">1972</option>
        <option value="1971">1971</option>
        <option value="1970">1970</option>
        <option value="1969">1969</option>
        <option value="1968">1968</option>
        <option value="1967">1967</option>
        <option value="1966">1966</option>
        <option value="1965">1965</option>
        <option value="1964">1964</option>
        <option value="1963">1963</option>
        <option value="1962">1962</option>
        <option value="1961">1961</option>
        <option value="1960">1960</option>
        <option value="1959">1959</option>
        <option value="1958">1958</option>
        <option value="1957">1957</option>
        <option value="1956">1956</option>
        <option value="1955">1955</option>
        <option value="1954">1954</option>
        <option value="1953">1953</option>
        <option value="1952">1952</option>
        <option value="1951">1951</option>
        <option value="1950">1950</option>
        <option value="1949">1949</option>
        <option value="1948">1948</option>
        <option value="1947">1947</option>
        <option value="1946">1946</option>
        <option value="1945">1945</option>
        <option value="1944">1944</option>
        <option value="1943">1943</option>
        <option value="1942">1942</option>
        <option value="1941">1941</option>
        <option value="1940">1940</option>
      </select>
    </div>
    <span class="tip">年</span>
  </span>
                            <span>
    <div class="ui-select">
      <select name="month" class="ui-select">
        <option>--</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
        <option value="10">10</option>
        <option value="11">11</option>
        <option value="12">12</option>
      </select>
    </div>
    <span class="tip">月</span>
  </span>
                            <span>
    <div class="ui-select">
      <select name="day" class="ui-select">
        <option>--</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
        <option value="10">10</option>
        <option value="11">11</option>
        <option value="12">12</option>
        <option value="13">13</option>
        <option value="14">14</option>
        <option value="15">15</option>
        <option value="16">16</option>
        <option value="17">17</option>
        <option value="18">18</option>
        <option value="19">19</option>
        <option value="20">20</option>
        <option value="21">21</option>
        <option value="22">22</option>
        <option value="23">23</option>
        <option value="24">24</option>
        <option value="25">25</option>
        <option value="26">26</option>
        <option value="27">27</option>
        <option value="28">28</option>
        <option value="29">29</option>
        <option value="30">30</option>
        <option value="31">31</option>
      </select>
    </div>
    <span class="tip">日</span>
  </span>
                        </div>

                        <div class="userexinfo-form-section">
                            <p>生活状态：</p>
                            <span>
              <input type="radio" name="marriage" id="userexinfo-form-merriage-1" value="1" class="ui-radio radio-first"   >
              <label for="userexinfo-form-merriage-1">单身</label>
            </span>
                            <span>
              <input type="radio" name="marriage" id="userexinfo-form-merriage-2" value="2" class="ui-radio" >
              <label for="userexinfo-form-merriage-2">热恋中</label>
            </span>
                            <span>
              <input type="radio" name="marriage" id="userexinfo-form-merriage-3" value="3" class="ui-radio" >
              <label for="userexinfo-form-merriage-3">已婚</label>
            </span>
                            <span>
              <input type="radio" name="marriage" id="userexinfo-form-merriage-4" value="4" class="ui-radio" >
              <label for="userexinfo-form-merriage-4">为人父母</label>
            </span>
                        </div>
                        <div class="userexinfo-form-section">
                            <p>从事行业：</p>
                            <span>
              <div class="ui-select">
                <select id="job" name="job" class="ui-select">
                  <option value="">--</option>
                  <option value="信息技术">信息技术</option>
                  <option value="金融保险">金融保险</option>
                  <option value="商业服务">商业服务</option>
                  <option value="建筑地产">建筑地产</option>
                  <option value="工程制造">工程制造</option>
                  <option value="交通运输">交通运输</option>
                  <option value="文化传媒">文化传媒</option>
                  <option value="娱乐体育">娱乐体育</option>
                  <option value="公共事业">公共事业</option>
                  <option value="学生">学生</option>
                  <option value="其他">其他</option>
                </select>
              </div>
              <div class="ui-select">
                <select id="subjob" name="occupation" class="ui-select">
                </select>
              </div>
            </span>
                        </div>

                        <div class="userexinfo-form-section expand-list">
                            <p>兴趣：</p>
                            <div class="interest-list">
              <span>
                <input type="checkbox" name="interest[]" id="userexinfo-form-interest-1" value="1" class="ui-checkbox">
                <label for="userexinfo-form-interest-1">美食</label>
              </span>
                                <span>
                <input type="checkbox" name="interest[]" id="userexinfo-form-interest-2" value="2" class="ui-checkbox" >
                <label for="userexinfo-form-interest-2">动漫</label>
              </span>
                                <span>
                <input type="checkbox" name="interest[]" id="userexinfo-form-interest-3" value="3" class="ui-checkbox" >
                <label for="userexinfo-form-interest-3">摄影</label>
              </span>
                                <span>
                <input type="checkbox" name="interest[]" id="userexinfo-form-interest-4" value="4" class="ui-checkbox" >
                <label for="userexinfo-form-interest-4">电影</label>
              </span>
                                <span>
                <input type="checkbox" name="interest[]" id="userexinfo-form-interest-5" value="5" class="ui-checkbox" >
                <label for="userexinfo-form-interest-5">体育</label>
              </span>
                                <span>
                <input type="checkbox" name="interest[]" id="userexinfo-form-interest-6" value="6" class="ui-checkbox" >
                <label for="userexinfo-form-interest-6">财经</label>
              </span>
                                <span>
                <input type="checkbox" name="interest[]" id="userexinfo-form-interest-7" value="7" class="ui-checkbox">
                <label for="userexinfo-form-interest-7">音乐</label>
              </span>
                                <span>
                <input type="checkbox" name="interest[]" id="userexinfo-form-interest-8" value="8" class="ui-checkbox" >
                <label for="userexinfo-form-interest-8">游戏</label>
              </span>
                                <span>
                <input type="checkbox" name="interest[]" id="userexinfo-form-interest-9" value="9" class="ui-checkbox" >
                <label for="userexinfo-form-interest-9">科技</label>
              </span>
                                <span>
                <input type="checkbox" name="interest[]" id="userexinfo-form-interest-10" value="10" class="ui-checkbox" >
                <label for="userexinfo-form-interest-10">旅游</label>
              </span>
                                <span>
                <input type="checkbox" name="interest[]" id="userexinfo-form-interest-11" value="11" class="ui-checkbox" >
                <label for="userexinfo-form-interest-11">文学</label>
              </span>
                                <span>
                <input type="checkbox" name="interest[]" id="userexinfo-form-interest-12" value="12" class="ui-checkbox" >
                <label for="userexinfo-form-interest-12">公益</label>
              </span>
                                <span>
                <input type="checkbox" name="interest[]" id="userexinfo-form-interest-13" value="13" class="ui-checkbox" >
                <label for="userexinfo-form-interest-13">汽车</label>
              </span>
                                <span>
                <input type="checkbox" name="interest[]" id="userexinfo-form-interest-14" value="14" class="ui-checkbox" >
                <label for="userexinfo-form-interest-14">时尚</label>
              </span>
                                <span>
                <input type="checkbox" name="interest[]" id="userexinfo-form-interest-15" value="15" class="ui-checkbox" >
                <label for="userexinfo-form-interest-15">宠物</label>
              </span>
                                <span class="bottom-tips">选择你的兴趣使你获得个性化的电影推荐哦</span>
                            </div>
                        </div>
                        <div class="userexinfo-form-section">
                            <p>个性签名：</p>
                            <span>
              <input type="text" name="signature" id="userexinfo-form-bio" class="ui-checkbox" placeholder="20个字以内">
            </span>
                        </div>
                        <input type="hidden" name="user_id" id="user_id" >
                        <div class="userexinfo-bottom-section clearfix">
                            <input type="button" id="modify_user" class="form-save-btn" value="保存">
                            <!-- <span id="cancell-btn" class="cancel_alert hand">注销账号1</span> -->
                        </div>

                    </form>
                </div>

            </div>
        </div>

        <div class="body-mask"></div>
        <div id="img-cropper" class="img-cropper">
            <div class="img-cropper-container">
                <div class="img-cropper-header">
                    上传头像
                    <span class="close-icon"></span>
                </div>
                <div class="img-cropper-content">
                    <div class="img-main">
                        <div class="img-main-wrapper">
                            <img src="https://img.meituan.net/maoyanuser/63957f10ae9679c95d4ba26ad1bd29c816882.png">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script>
            var occupation = {"信息技术":["互联网","IT","通信","电子","游戏"],"金融保险":["投资","股票基金","保险","银行","信托担保"],"商业服务":["资讯","贸易","美容保健","家政服务","旅游","餐饮酒店","娱乐休闲","批发零售","汽车"],"建筑地产":["房地产","建筑","物业","装修"],"工程制造":["机械制造","生物医药","食品","服装","能源","化工"],"交通运输":["航空","铁路","航运船舶","公共交通","物流运输"],"文化传媒":["媒体出版","设计","广告创意","动漫","公关会展","摄影"],"娱乐体育":["影视","运动体育","音乐","模特"],"公共事业":["医疗","教育","政府机关","科研","公益机构","农林牧渔"],"学生":["学生"],"其他":["其他"]};
        </script>
    </div>

    <div class="mask3">
        <div class="modal-container" style="display:none">
            <div class="modal">
                <span class="icon"></span>

                <p class="tip">您确定要删除该订单嘛？删除后，不可恢复～</p>

                <div class="short btn ok-btn">确定</div>
                <div class="short btn cancel-btn">取消</div>
            </div>
        </div>

    </div>

    <div class='mask1'>
        <div class="modal-container" style="display:none">
            <div class="modal">
                <span class="icon"></span>

                <p class="tip">请注意，注销账号会清空所有订单信息、影评、积分、<br>账户余额等信息且无法找回，是否继续？</p>

                <div class="short btn ok-btn">确定</div>
                <div class="short btn cancel-btn">取消</div>
            </div>
        </div>

    </div>

    <div class='mask2'>
        <div class="modal-container" style="display:none">
            <div class="modal">
                <span class="icon"></span>

                <p class="tip">请联系客服10105335</p>

                <div class="ok-btn btn">我知道了</div>
            </div>
        </div>

    </div>

    <div class="footer">
        <p >
            如有抄袭，请联系客服
        </p>
    </div>

</div>

<script crossorigin="anonymous" src="//www.dpfile.com/app/owl/static/owl_1.7.11.js"></script>
<!-- jquery -->
<script src="../static/user/js/jquery.min.js"></script>
<!-- dropzone -->
<script src="../static/user/js/dropzone.js"></script>
<script>

    $(document).ready(function(){

        $.ajax({
            type : "get",
            url : "/api/user/getUserInfo",
            dataType : "json",
            success : function (data) {
                var json = data;
                //请求参数返回的全局响应，默认为200
                if (json.code == '200'){
                    //登陆成功返回的响应，成功为1
                    if (json.data.success == 1){
                        $("#li_title").attr("title",json.data.username);
                        if (json.data.image != null && json.data.image != "") {
                            $("#personImg").attr("src",json.data.image);
                            $("#small_persionImg").attr("src",json.data.image);
                        }
                        $("#userexinfo-form-nickname").val(json.data.username);
                        $("#userexinfo-form-gender-"+json.data.gender).attr("checked","checked")
                        $("select[name='year'] option[value="+json.data.birth_year+"]").attr("selected","selected");
                        $("select[name='month'] option[value="+json.data.birth_month+"]").attr("selected","selected");
                        $("select[name='day'] option[value="+json.data.birth_day+"]").attr("selected","selected");
                        $("#userexinfo-form-merriage-"+json.data.life).attr("checked","checked")
                        $("#job option[value='"+json.data.trade+"']").attr("selected","selected");
                        subJob(json.data.trade,json.data.job);
                        if (json.data.interests != null && json.data.interests.length > 0) {
                            for(var i = 0 ; i < json.data.interests.length ; i ++){
                                $("#userexinfo-form-interest-"+json.data.interests[i]).attr("checked","checked")
                            }
                        }
                        $("#userexinfo-form-bio").val(json.data.signature);
                        $("#user_id").val(json.data.id);

                    }
                    //登陆失败为0
                    else if (json.data.success == 0){
                        alert("请先登录");
                        window.location.href = "/static/login.html";
                    }
                }else {
                    alert(json.msg);
                }
            },
            error : function () {
                alert("登陆异常")
            }
        });

        $("#modify_user").click(function () {
            var param = {};
            param.id = $("#user_id").val();
            param.username = $("#userexinfo-form-nickname").val();
            param.gender = $("input:radio[name='gender']:checked")[0].defaultValue;
            param.birth_year = $("select[name='year']").val();
            param.birth_month = $("select[name='month']").val();
            param.birth_day = $("select[name='day']").val();
            param.life = $("input:radio[name='marriage']:checked")[0].defaultValue;
            param.trade = $("#job").val();
            param.job = $("#subjob").val();
            if ($("input:checkbox[name='interest[]']:checked").length > 0){
                var interest = new Array();
                var list = $("input:checkbox[name='interest[]']:checked");
                for (var i = 0 ; i < list.length ; i ++){
                    interest[i] = list[i].value;
                }
                param.interests = interest;
            }
            param.signature = $("#userexinfo-form-bio").val();

            $.ajax({
            type : "POST",
            url : "/api/user/modifyUser",
            dataType : "json",
            contentType : "application/json;charset=UTF-8",
            data : JSON.stringify(param),
            success : function (data) {
                var json = data;
                //请求参数返回的全局响应，默认为200
                if (json.code == '200'){
                    //登陆成功返回的响应，成功为1
                    if (json.data.success == 1){
                        alert("保存成功");
                    }
                    //登陆失败为0
                    else if (json.data.success == 0){
                        alert("保存失败");
                    }
                }else {
                    alert(json.msg);
                }
            },
            error : function () {
                alert("登陆异常")
            }
            });
        });

        $("#userLogout").click(function () {
            $.get("/api/user/mUserLogOut");
        });
    });

    function subJob(trade , job){
        var occupation = {
            "信息技术": ["互联网", "IT", "通信", "电子", "游戏"],
            "金融保险": ["投资", "股票基金", "保险", "银行", "信托担保"],
            "商业服务": ["资讯", "贸易", "美容保健", "家政服务", "旅游", "餐饮酒店", "娱乐休闲", "批发零售", "汽车"],
            "建筑地产": ["房地产", "建筑", "物业", "装修"],
            "工程制造": ["机械制造", "生物医药", "食品", "服装", "能源", "化工"],
            "交通运输": ["航空", "铁路", "航运船舶", "公共交通", "物流运输"],
            "文化传媒": ["媒体出版", "设计", "广告创意", "动漫", "公关会展", "摄影"],
            "娱乐体育": ["影视", "运动体育", "音乐", "模特"],
            "公共事业": ["医疗", "教育", "政府机关", "科研", "公益机构", "农林牧渔"],
            "学生": ["学生"],
            "其他": ["其他"]
        };

        if (trade != null && trade != "") {
            occupation[trade].forEach(function (value) {
                var option = document.createElement("option");
                option.value = value;
                option.text = value;
                $("#subjob").append(option);
            });
            $("#subjob").val(job);
        }
    }

    Dropzone.autoDiscover = false;
    $(document).ready(function () {
        var appElement = document.querySelector('div .inmodal');
        var myDropzone = new Dropzone("#dropz", {
            url: "/upload/image",//文件提交地址
            method: "post",  //也可用put
            paramName: "file", //默认为file
            maxFiles: 1,//一次性上传的文件数量上限
            maxFilesize: 1, //文件大小，单位：MB
            acceptedFiles: ".jpg,.gif,.png,.jpeg", //上传的类型
            addRemoveLinks: true,
            parallelUploads: 1,//一次上传的文件数量
            //previewsContainer:"#preview",//上传图片的预览窗口
            dictDefaultMessage: '拖动文件至此或者点击上传',
            dictMaxFilesExceeded: "您最多只能上传1个文件！",
            dictResponseError: '文件上传失败!',
            dictInvalidFileType: "文件类型只能是*.jpg,*.gif,*.png,*.jpeg。",
            dictFallbackMessage: "浏览器不受支持",
            dictFileTooBig: "文件过大上传文件最大支持.",
            dictRemoveLinks: "删除",
            dictCancelUpload: "取消",
            init: function () {
                this.on("addedfile", function (file) {
                    //上传文件时触发的事件
                    document.querySelector('div .dz-default').style.display = 'none';
                });
                this.on("success", function (file, data) {
                    //上传成功触发的事件
                    $("#file_id").hide();
                    $("#personImg").show();
                    $("#personImg").attr("src",data.name);
                    $("#small_persionImg").attr("src",data.name);
                    $.ajax({
                        type : "POST",
                        url : "/api/user/saveUserImage",
                        dataType : "json",
                        contentType : "application/json;charset=UTF-8",
                        data : JSON.stringify({
                            "image" : data.name,
                            "userId" : $("#user_id").val()
                        }),
                        success : function (data) {
                            var json = data;
                            //请求参数返回的全局响应，默认为200
                            if (json.code == '200'){
                                //登陆成功返回的响应，成功为1
                                if (json.data == 1){
                                    alert("头像上传成功");
                                }
                                //登陆失败为0
                                else if (json.data == 0){
                                    alert("头像上传失败，请重新上传");
                                }
                            }
                        },
                        error : function () {
                            alert("上传失败")
                        }
                    });
                });
                this.on("error", function (file, data) {
                    //上传失败触发的事件
                    console.log('fail');
                    var message = '';
                    //lavarel框架有一个表单验证，
                    //对于ajax请求，JSON 响应会发送一个 422 HTTP 状态码，
                    //对应file.accepted的值是false，在这里捕捉表单验证的错误提示
                    if (file.accepted) {
                        $.each(data, function (key, val) {
                            message = message + val[0] + ';';
                        })
                        //控制器层面的错误提示，file.accepted = true的时候；
                        alert(message);
                    }
                });
                /*this.on("removedfile", function (file) {
                    //删除文件时触发的方法
                    var file_id = angular.element(appElement).scope().file_id;
                    if (file_id) {
                        $.post('/admin/del/' + file_id, {'_method': 'DELETE'}, function (data) {
                            console.log('删除结果:' + data.message);
                        })
                    }
                    angular.element(appElement).scope().file_id = 0;
                    document.querySelector('div .dz-default').style.display = 'block';
                });*/
            }
        });

        $("#upload_id").click(function () {
            $("#personImg").hide();
            $("#file_id").show();
        });

    });

    Owl.start({
        project: 'com.sankuai.movie.fe.mywww',
        pageUrl: location.href.split('?')[0].replace(/\/\d+/g, '/:id'),
        devMode: false
    })
    // 单独自定义上报下img加载错误
           window.addEventListener('error', function(e) {
            var node = e.target || e.srcElement
            try {
                var msg = node.src || node.href
                var nodeName = node.nodeName
                if (nodeName && nodeName.toLowerCase() === 'img') {
                    Owl.addError(msg, {level: 'warn', category: 'resourceError'})
                }
            } catch(err) {
                console.error(err)
            }
        }, true)


</script>
<!--[if IE 8]><script crossorigin="anonymous" src="//s0.meituan.net/bs/?f=myfe/mywww:/es5-shim.bbad933f.js"></script><![endif]-->
<!--[if IE 8]><script crossorigin="anonymous" src="//s0.meituan.net/bs/?f=myfe/mywww:/es5-sham.d6ea26f4.js"></script><![endif]-->
<script crossorigin="anonymous" src="//s0.meituan.net/bs/?f=myfe/mywww:/common.98f4f69f.js"></script>
<script crossorigin="anonymous" src="//s0.meituan.net/bs/?f=myfe/mywww:/profile-profile.c72043d3.js"></script>
</body>
</html>
